LoadFieldEliminationStaticTest
---
InlineFunctionCalls
Simplify
BeginInlinedFunctionElimination
LoadFieldElimination
Simplify
---
RemoveLoadFieldBeforeStoreField
---
class C:
  def __init__(self):
    self.a = 3
    self.b = 4

def test():
  return C()
---
fun jittestmodule:test {
  bb 0 {
    v22:Nullptr = LoadConst<Nullptr>
    v3:ObjectUser[C:Exact] = TpAlloc<C> {
      FrameState {
        NextInstrOffset 4
      }
    }
    v4:MortalFunc[function:0xdeadbeef] = LoadConst<MortalFunc[function:0xdeadbeef]>
    v14:ImmortalLongExact[3] = LoadConst<ImmortalLongExact[3]>
    StoreField<a@16> v3 v14 v22
    v17:ImmortalLongExact[4] = LoadConst<ImmortalLongExact[4]>
    StoreField<b@24> v3 v17 v22
    v20:NoneType = LoadConst<NoneType>
    Return v3
  }
}
---
RemoveLoadFieldAfterStoreField
---
class C:
  def __init__(self):
    self.a = 3
    self.b = 4

def test():
  c = C()
  return c.a + c.b
---
fun jittestmodule:test {
  bb 0 {
    v7:Nullptr = LoadConst<Nullptr>
    v35:Nullptr = LoadConst<Nullptr>
    v8:ObjectUser[C:Exact] = TpAlloc<C> {
      FrameState {
        NextInstrOffset 4
        Locals<1> v7
      }
    }
    v9:MortalFunc[function:0xdeadbeef] = LoadConst<MortalFunc[function:0xdeadbeef]>
    v27:ImmortalLongExact[3] = LoadConst<ImmortalLongExact[3]>
    StoreField<a@16> v8 v27 v35
    v30:ImmortalLongExact[4] = LoadConst<ImmortalLongExact[4]>
    StoreField<b@24> v8 v30 v35
    v33:NoneType = LoadConst<NoneType>
    UseType<LongExact> v27
    UseType<LongExact> v30
    UseType<ImmortalLongExact[3]> v27
    UseType<ImmortalLongExact[4]> v30
    v37:ImmortalLongExact[7] = LoadConst<ImmortalLongExact[7]>
    Return v37
  }
}
---
DontRemoveLoadFieldAcrossMemoryEffects
---
class C:
  def __init__(self):
    self.a = 3

def test():
  c = C()
  print(c)
  return c.a
---
fun jittestmodule:test {
  bb 0 {
    v7:Nullptr = LoadConst<Nullptr>
    v30:Nullptr = LoadConst<Nullptr>
    v8:ObjectUser[C:Exact] = TpAlloc<C> {
      FrameState {
        NextInstrOffset 4
        Locals<1> v7
      }
    }
    v9:MortalFunc[function:0xdeadbeef] = LoadConst<MortalFunc[function:0xdeadbeef]>
    v25:ImmortalLongExact[3] = LoadConst<ImmortalLongExact[3]>
    StoreField<a@16> v8 v25 v30
    v28:NoneType = LoadConst<NoneType>
    v12:OptObject = LoadGlobalCached<0; "print">
    v13:MortalObjectUser[builtin_function_or_method:print:0xdeadbeef] = GuardIs<0xdeadbeef> v12 {
      Descr 'LOAD_GLOBAL: print'
    }
    v15:Object = VectorCall<1> v13 v8 {
      FrameState {
        NextInstrOffset 20
        Locals<1> v8
      }
    }
    v17:OptObject = LoadField<a@16, OptObject, borrowed> v8
    v18:Object = CheckField<"a"> v17 {
      GuiltyReg v8
      FrameState {
        NextInstrOffset 26
        Locals<1> v8
      }
    }
    Return v18
  }
}
---
